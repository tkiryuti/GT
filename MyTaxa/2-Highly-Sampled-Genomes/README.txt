Quality Filtering and Dereplication of Highly Sampled Species

The 21 species with over 2,000 genomes were dereplicated to reduce the computational difficulty for further steps. Quality assessment using CheckM was performed on all their genomes from the NCBI assembly database, and only genomes with > 80 % completeness, < 4 % contamination, and > 80 % quality were used (Parks et al. 2015). These genomes were further dereplicated by creating clusters of ≥ 99 % ANI estimate from FastANI and ≥ 50 % of the genome shared, using greedy incremental clustering by length starting from largest genome in base pairs (Jain et al. 2018). The FastANI program was set to trust ANI estimates of pairs with at least 50 % of the smaller genome shared. The clustering for 99 % dereplication was highly parallelized using Launcher to make it computationally feasible to complete. The protein sequences of the representatives (longest genomes) of these clusters were used in subsequent steps.
